---
import { toolsConfig, type Language } from '../../data/tools';

interface Props {
  currentSlug: string;
  currentCategory: string;
  lang?: Language;
}

const { currentSlug, currentCategory, lang = 'ko' } = Astro.props;

const translations = {
  ko: 'ê´€ë ¨ ë„êµ¬',
  en: 'Related Tools',
  ja: 'é–¢é€£ãƒ„ãƒ¼ãƒ«',
};

const relatedTitle = translations[lang] || translations.ko;

// Get tools from toolsConfig and filter related ones
const relatedTools = toolsConfig
  .filter(tool => tool.slug !== currentSlug)
  .sort((a, b) => {
    if (a.category === currentCategory && b.category !== currentCategory) return -1;
    if (a.category !== currentCategory && b.category === currentCategory) return 1;
    return 0;
  })
  .slice(0, 4)
  .map(tool => ({
    slug: tool.slug,
    title: tool.seo[lang]?.title.split(' - ')[0] || tool.seo.ko.title.split(' - ')[0],
    description: tool.seo[lang]?.description || tool.seo.ko.description,
    icon: tool.icon,
  }));
---

<section class="mt-12 pt-8 border-t border-[var(--color-border)]">
  <h2 class="text-xl font-bold text-[var(--color-text)] mb-6 flex items-center gap-2">
    <span>ðŸ”§</span> {relatedTitle}
  </h2>
  <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
    {relatedTools.map((tool) => (
      <a
        href={`/${lang}/tools/${tool.slug}`}
        class="group flex items-center gap-4 p-4 rounded-xl
          bg-[var(--color-card)] border border-[var(--color-border)]
          hover:border-primary-500 hover:shadow-md transition-all"
      >
        <span class="text-2xl">{tool.icon}</span>
        <div class="flex-1 min-w-0">
          <h3 class="font-semibold text-[var(--color-text)] group-hover:text-primary-500 transition-colors">
            {tool.title}
          </h3>
          <p class="text-sm text-[var(--color-text-muted)] truncate">
            {tool.description}
          </p>
        </div>
        <svg class="w-5 h-5 text-[var(--color-text-muted)] group-hover:text-primary-500 transition-colors flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
        </svg>
      </a>
    ))}
  </div>
</section>
