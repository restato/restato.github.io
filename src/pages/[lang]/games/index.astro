---
import MainLayout from '../../../layouts/MainLayout.astro';
import { gamesConfig, getFeaturedGames, getGamesByCategory } from '../../../data/games';
import type { Language } from '../../../i18n/index';

export function getStaticPaths() {
  return [
    { params: { lang: 'ko' } },
    { params: { lang: 'en' } },
    { params: { lang: 'ja' } },
  ];
}

const { lang } = Astro.params as { lang: Language };

const featuredGames = getFeaturedGames();
const arcadeGames = getGamesByCategory('arcade');
const puzzleGames = getGamesByCategory('puzzle');
const eventGames = getGamesByCategory('event');
const classicGames = getGamesByCategory('classic');

const translations = {
  ko: {
    title: 'Î¨¥Î£å Ïò®ÎùºÏù∏ Í≤åÏûÑ | Restato',
    description: 'Î¨¥Î£å Ïò®ÎùºÏù∏ ÎØ∏ÎãàÍ≤åÏûÑ Î™®Ïùå. Ïä§ÎÑ§Ïù¥ÌÅ¨, 2048, ÌÉÄÏù¥Ìïë, Î£∞Î†õ, ÏÇ¨Îã§Î¶¨ ÌÉÄÍ∏∞ Îì± Îã§ÏñëÌïú Í≤åÏûÑÏùÑ Ï¶êÍ∏∞ÏÑ∏Ïöî.',
    heading: 'Î¨¥Î£å Ïò®ÎùºÏù∏ Í≤åÏûÑ',
    subheading: 'Î∏åÎùºÏö∞Ï†ÄÏóêÏÑú Î∞îÎ°ú ÌîåÎ†àÏù¥ÌïòÎäî ÎØ∏ÎãàÍ≤åÏûÑ',
    featured: 'Ï∂îÏ≤ú Í≤åÏûÑ',
    arcade: 'ÏïÑÏºÄÏù¥Îìú Í≤åÏûÑ',
    puzzle: 'ÌçºÏ¶ê / ÎëêÎáå Í≤åÏûÑ',
    event: 'Ïù¥Î≤§Ìä∏ / Ï∂îÏ≤®',
    classic: 'ÌÅ¥ÎûòÏãù Í≤åÏûÑ',
    playNow: 'ÌîåÎ†àÏù¥',
  },
  en: {
    title: 'Free Online Games | Restato',
    description: 'Free online mini-game collection. Enjoy Snake, 2048, Typing, Roulette, Ladder and more.',
    heading: 'Free Online Games',
    subheading: 'Mini games you can play directly in your browser',
    featured: 'Featured Games',
    arcade: 'Arcade Games',
    puzzle: 'Puzzle / Brain Games',
    event: 'Event / Raffle',
    classic: 'Classic Games',
    playNow: 'Play',
  },
  ja: {
    title: 'ÁÑ°Êñô„Ç™„É≥„É©„Ç§„É≥„Ç≤„Éº„É† | Restato',
    description: 'ÁÑ°Êñô„Ç™„É≥„É©„Ç§„É≥„Éü„Éã„Ç≤„Éº„É†ÈõÜ„ÄÇ„Çπ„Éç„Éº„ÇØ„ÄÅ2048„ÄÅ„Çø„Ç§„Éî„É≥„Ç∞„ÄÅ„É´„Éº„É¨„ÉÉ„Éà„ÄÅ„ÅÇ„Åø„Å†„Åè„Åò„Å™„Å©Êßò„ÄÖ„Å™„Ç≤„Éº„É†„ÇíÊ•Ω„Åó„ÇÇ„ÅÜ„ÄÇ',
    heading: 'ÁÑ°Êñô„Ç™„É≥„É©„Ç§„É≥„Ç≤„Éº„É†',
    subheading: '„Éñ„É©„Ç¶„Ç∂„ÅßÁõ¥Êé•„Éó„É¨„Ç§„Åß„Åç„Çã„Éü„Éã„Ç≤„Éº„É†',
    featured: '„Åä„Åô„Åô„ÇÅ„Ç≤„Éº„É†',
    arcade: '„Ç¢„Éº„Ç±„Éº„Éâ„Ç≤„Éº„É†',
    puzzle: '„Éë„Ç∫„É´ / ËÑ≥„Éà„É¨',
    event: '„Ç§„Éô„É≥„Éà / ÊäΩÈÅ∏',
    classic: '„ÇØ„É©„Ç∑„ÉÉ„ÇØ„Ç≤„Éº„É†',
    playNow: '„Éó„É¨„Ç§',
  },
};

const t = translations[lang];

// JSON-LD Schema
const gamesSchema = {
  "@context": "https://schema.org",
  "@type": "ItemList",
  "name": t.heading,
  "description": t.description,
  "numberOfItems": gamesConfig.length,
  "itemListElement": gamesConfig.map((game, index) => ({
    "@type": "ListItem",
    "position": index + 1,
    "item": {
      "@type": "Game",
      "name": game.seo[lang].title,
      "description": game.seo[lang].description,
      "url": `https://restato.github.io/${lang}/games/${game.slug}`,
      "gamePlatform": "Web Browser",
      "applicationCategory": "Game",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      }
    }
  }))
};
---

<MainLayout title={t.title} description={t.description} lang={lang}>
  <script type="application/ld+json" set:html={JSON.stringify(gamesSchema)} />

  <section class="py-12 px-4">
    <div class="max-w-6xl mx-auto">
      <!-- Header -->
      <div class="text-center mb-12">
        <h1 class="text-4xl md:text-5xl font-bold mb-4 bg-gradient-to-r from-primary-500 to-purple-500 bg-clip-text text-transparent">
          {t.heading}
        </h1>
        <p class="text-lg text-[var(--color-text-muted)]">
          {t.subheading}
        </p>
      </div>

      <!-- Featured Games -->
      {featuredGames.length > 0 && (
        <div class="mb-12">
          <h2 class="text-2xl font-bold mb-6 flex items-center gap-2">
            <span>‚≠ê</span> {t.featured}
          </h2>
          <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4">
            {featuredGames.map(game => (
              <a
                href={`/${lang}/games/${game.slug}`}
                class="group p-4 bg-gradient-to-br from-primary-500/10 to-purple-500/10 rounded-xl border border-primary-500/30 hover:border-primary-500 transition-all hover:shadow-lg hover:-translate-y-1"
              >
                <div class="text-4xl mb-3">{game.icon}</div>
                <h3 class="font-bold mb-1 group-hover:text-primary-500 transition-colors">
                  {game.seo[lang].title.split(' - ')[0]}
                </h3>
                <p class="text-sm text-[var(--color-text-muted)] line-clamp-2">
                  {game.seo[lang].description.slice(0, 60)}...
                </p>
              </a>
            ))}
          </div>
        </div>
      )}

      <!-- Arcade Games -->
      {arcadeGames.length > 0 && (
        <div class="mb-12">
          <h2 class="text-2xl font-bold mb-6 flex items-center gap-2">
            <span>üïπÔ∏è</span> {t.arcade}
          </h2>
          <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4">
            {arcadeGames.map(game => (
              <a
                href={`/${lang}/games/${game.slug}`}
                class="group p-4 bg-[var(--color-card)] rounded-xl border border-[var(--color-border)] hover:border-primary-500 transition-all hover:shadow-lg hover:-translate-y-1"
              >
                <div class="text-3xl mb-2">{game.icon}</div>
                <h3 class="font-bold text-sm group-hover:text-primary-500 transition-colors">
                  {game.seo[lang].title.split(' - ')[0]}
                </h3>
              </a>
            ))}
          </div>
        </div>
      )}

      <!-- Puzzle Games -->
      {puzzleGames.length > 0 && (
        <div class="mb-12">
          <h2 class="text-2xl font-bold mb-6 flex items-center gap-2">
            <span>üß©</span> {t.puzzle}
          </h2>
          <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4">
            {puzzleGames.map(game => (
              <a
                href={`/${lang}/games/${game.slug}`}
                class="group p-4 bg-[var(--color-card)] rounded-xl border border-[var(--color-border)] hover:border-primary-500 transition-all hover:shadow-lg hover:-translate-y-1"
              >
                <div class="text-3xl mb-2">{game.icon}</div>
                <h3 class="font-bold text-sm group-hover:text-primary-500 transition-colors">
                  {game.seo[lang].title.split(' - ')[0]}
                </h3>
              </a>
            ))}
          </div>
        </div>
      )}

      <!-- Event Games -->
      {eventGames.length > 0 && (
        <div class="mb-12">
          <h2 class="text-2xl font-bold mb-6 flex items-center gap-2">
            <span>üéâ</span> {t.event}
          </h2>
          <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4">
            {eventGames.map(game => (
              <a
                href={`/${lang}/games/${game.slug}`}
                class="group p-4 bg-[var(--color-card)] rounded-xl border border-[var(--color-border)] hover:border-primary-500 transition-all hover:shadow-lg hover:-translate-y-1"
              >
                <div class="text-3xl mb-2">{game.icon}</div>
                <h3 class="font-bold text-sm group-hover:text-primary-500 transition-colors">
                  {game.seo[lang].title.split(' - ')[0]}
                </h3>
              </a>
            ))}
          </div>
        </div>
      )}

      <!-- Classic Games -->
      {classicGames.length > 0 && (
        <div class="mb-12">
          <h2 class="text-2xl font-bold mb-6 flex items-center gap-2">
            <span>üéÆ</span> {t.classic}
          </h2>
          <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4">
            {classicGames.map(game => (
              <a
                href={`/${lang}/games/${game.slug}`}
                class="group p-4 bg-[var(--color-card)] rounded-xl border border-[var(--color-border)] hover:border-primary-500 transition-all hover:shadow-lg hover:-translate-y-1"
              >
                <div class="text-3xl mb-2">{game.icon}</div>
                <h3 class="font-bold text-sm group-hover:text-primary-500 transition-colors">
                  {game.seo[lang].title.split(' - ')[0]}
                </h3>
              </a>
            ))}
          </div>
        </div>
      )}
    </div>
  </section>
</MainLayout>
