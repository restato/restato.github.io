---
import MainLayout from '../../../layouts/MainLayout.astro';
import ToolSearch from '../../../components/tools/ToolSearch';
import RecentTools from '../../../components/tools/RecentTools';
import ToolsGrid from '../../../components/tools/ToolsGrid';
import ToolsPageHeader from '../../../components/tools/ToolsPageHeader';
import ToolsPageInfo from '../../../components/tools/ToolsPageInfo';
import { toolsConfig, categories, type Language } from '../../../data/tools';

const languages: Language[] = ['ko', 'en', 'ja'];

export function getStaticPaths() {
  return [
    { params: { lang: 'ko' } },
    { params: { lang: 'en' } },
    { params: { lang: 'ja' } }
  ];
}

const { lang } = Astro.params as { lang: Language };

// SEO content per language
const seoContent = {
  ko: {
    title: 'ë¬´ë£Œ ì˜¨ë¼ì¸ ë„êµ¬ ëª¨ìŒ | Restato',
    description: 'ë¬´ë£Œ ì˜¨ë¼ì¸ ë„êµ¬ ëª¨ìŒ - QR ì½”ë“œ ìƒì„±ê¸°, ë¹„ë°€ë²ˆí˜¸ ìƒì„±ê¸°, ìƒ‰ìƒ ë³€í™˜ê¸°, JSON í¬ë§¤í„°, ì´ë¯¸ì§€ ë³€í™˜ê¸° ë“± 40ê°œ ì´ìƒì˜ ë¬´ë£Œ ì›¹ ë„êµ¬. ë¬´ì„¤ì¹˜, íšŒì›ê°€ì… ë¶ˆí•„ìš”.',
  },
  en: {
    title: 'Free Online Tools Collection | Restato',
    description: 'Free online tools collection - QR code generator, password generator, color converter, JSON formatter, image converter and 40+ free web tools. No installation, no signup required.',
  },
  ja: {
    title: 'ç„¡æ–™ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ãƒ„ãƒ¼ãƒ«é›† | Restato',
    description: 'ç„¡æ–™ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ãƒ„ãƒ¼ãƒ«é›† - QRã‚³ãƒ¼ãƒ‰ç”Ÿæˆå™¨ã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç”Ÿæˆå™¨ã€ã‚«ãƒ©ãƒ¼å¤‰æ›å™¨ã€JSONãƒ•ã‚©ãƒ¼ãƒãƒƒã‚¿ãƒ¼ã€ç”»åƒå¤‰æ›å™¨ãªã©40ä»¥ä¸Šã®ç„¡æ–™ã‚¦ã‚§ãƒ–ãƒ„ãƒ¼ãƒ«ã€‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ä¸è¦ã€ä¼šå“¡ç™»éŒ²ä¸è¦ã€‚',
  },
};

// Generate alternate URLs for hreflang
const alternateUrls = languages.map(l => ({
  lang: l,
  url: `https://restato.github.io/${l}/tools`
}));

// Transform toolsConfig to the format expected by ToolsGrid
const tools = toolsConfig.map(tool => ({
  slug: tool.slug,
  title: {
    ko: tool.seo.ko.title.split(' - ')[0],
    en: tool.seo.en.title.split(' - ')[0],
    ja: tool.seo.ja.title.split(' - ')[0],
  },
  description: {
    ko: tool.seo.ko.description,
    en: tool.seo.en.description,
    ja: tool.seo.ja.description,
  },
  icon: tool.icon,
  category: tool.category,
}));

// Also add anonymous chat to tools list
tools.push({
  slug: `/${lang}/anonymous-chat`,
  title: { ko: 'ìµëª… ì±„íŒ…', en: 'Anonymous Chat', ja: 'åŒ¿åãƒãƒ£ãƒƒãƒˆ' },
  description: {
    ko: 'ë¬´ë£Œ ìµëª… 1:1 ì‹¤ì‹œê°„ ì±„íŒ…. P2P ì—°ê²°ë¡œ ì„œë²„ì— ì €ì¥ë˜ì§€ ì•ŠëŠ” ì•ˆì „í•œ ì±„íŒ….',
    en: 'Free anonymous 1:1 real-time chat. Secure P2P connection, nothing stored on servers.',
    ja: 'ç„¡æ–™åŒ¿å1:1ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒãƒ£ãƒƒãƒˆã€‚P2Pæ¥ç¶šã§ã‚µãƒ¼ãƒãƒ¼ã«ä¿å­˜ã•ã‚Œãªã„å®‰å…¨ãªãƒãƒ£ãƒƒãƒˆã€‚',
  },
  icon: 'ğŸ’¬',
  category: 'productivity',
});

const seo = seoContent[lang];
---

<MainLayout
  title={seo.title}
  description={seo.description}
  lang={lang}
  alternateUrls={alternateUrls}
>
  <div class="max-w-6xl mx-auto px-4 py-8">
    <!-- Header with i18n support -->
    <ToolsPageHeader client:load />

    <!-- Search -->
    <div class="mb-6">
      <ToolSearch client:load basePath={`/${lang}/tools`} />
    </div>

    <!-- Recent Tools -->
    <RecentTools client:load className="mb-8" basePath={`/${lang}/tools`} />

    <!-- Tools Grid with i18n support -->
    <ToolsGrid client:load tools={tools} categories={categories} basePath={`/${lang}/tools`} />

    <!-- Info with i18n support -->
    <ToolsPageInfo client:load />
  </div>
</MainLayout>
